{% set active_page = "Program" %}
{% set page_title = "Program" %}
{% extends "base.html" %}

{% block head %}
  {{ super() }}
  {% include 'schedule_head.html' %}
{% endblock %}

{% block tabs %}
  <div class="page-header text-center">
    <h1>Program</h1>
  </div>
  {{ components.tabs([
        ("schedule", "Schedule", "active"),
        ("speakers", "Keynote Speakers"),
        ("tutorials", "Tutorials")
    ])}}
{% endblock %}


{% block content %}
  <div class="page-content">
    <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
      <!-- Schedule tab -->
      <div
        class="tab-pane active"
        id="tab-schedule"
        role="tabpanel"
        aria-labelledby="nav-profile-tab"
      >
        {{ schedule | markdown }}
      </div>
      <!-- Keynote speakers tab -->
      <div
        class="tab-pane"
        id="tab-speakers"
        role="tabpanel"
        aria-labelledby="nav-profile-tab"
      >
        <!-- Speakers -->
        {% if speakers %}
          {{ components.speakergroup(speakers) }}
        {% endif %}
      </div>
      <!-- Tutorials tab -->
      <div
        class="tab-pane fade"
        id="tab-tutorials"
        role="tabpanel"
        aria-labelledby="nav-profile-tab"
      >
        {% if tutorials %}
          {{ components.workshopgroup(tutorials) }}
        {% endif %}
      </div>
    </div>
  </div>

  {# COMMENTED OUT
  <div class="tab-content py-3 px-3 px-sm-0" id="nav-tabContent">
    <!-- Calender tab -->
    <div
      class="tab-pane active"
      id="tab-calendar"
      role="tabpanel"
      aria-labelledby="nav-profile-tab"
    >
      <div class="form-group col">
        <label for="tzOptions">Timezone:</label>
        <select id="tzOptions" class="selectpicker" data-live-search="true">
        </select>
      </div>

      <!-- full cal for browser-->
      <div id="calendar" class="d-none d-sm-block"></div>

      <!-- small cal for smart phones-->
      <div id="calendar_small" class="d-sm-none"></div>

      <!--    <script type="text/javascript">-->
      <!--      // console.log(make_cal(),"-&#45;&#45; make_cal()");-->
      <!--      make_cal().then((d) => console.log(d, "-&#45;&#45; d"));-->
      <!--    </script>-->
    </div>

    <!-- Day Tab -->

    <div
      class="tab-pane fade"
      id="tab-day"
      role="tabpanel"
      aria-labelledby="nav-profile-tab"
    >
      <div id="day">
        <!-- Speakers -->
        {{ components.section("Speakers") }}
        <div class="speakers">
          {{ components.speakergroup(day.speakers) }}
        </div>
        {{ components.section("Highlighted Papers") }}
        <div class="papers">
          {{ components.highlightgroup(day.highlighted, 1) }}
        </div>
      </div>
    </div>
  </div>
  #}
{% endblock %}

{% block scripts %}
  {{ super() }}
  {% include 'schedule_scripts.html' %}

  {#
  <script type="text/javascript">
    window.onload = () => {
      const tabPanes = $(".tab-pane");
      // Create calendars:
      make_cal(false).then(({ render }) => {
        // render cal with all tabs visible
        tabPanes.css("display", "block");
        render();
        tabPanes.css("display", "");

        // re-render cal on resize
        $(window).on(
          "resize",
          _.debounce(() => {
            tabPanes.css("display", "block");
            render();
            tabPanes.css("display", "");
          }, 500)
        );
      });
      // ----
      lazyLoader();
    };
  </script>
  #}
{% endblock %}
